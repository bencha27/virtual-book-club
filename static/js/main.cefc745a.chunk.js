(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{113:function(e,t,s){"use strict";s.r(t);var n=s(1),a=s.n(n),c=s(79),r=s.n(c),i=s(18),l=s(16),o=s(6),d=s(82),j=s(126),b=s(128),m=s(125),u=s(80),O=s(32),p=s(33),x=s(64),h=new(function(){function e(){Object(O.a)(this,e)}return Object(p.a)(e,[{key:"login",value:function(e){localStorage.setItem("id_token",e),window.location.assign("/me")}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"isTokenExpired",value:function(e){return Object(x.a)(e).exp<Date.now()/1e3&&(localStorage.removeItem("id_token"),!0)}},{key:"getUser",value:function(){return Object(x.a)(this.getToken())}},{key:"loggedIn",value:function(){var e=this.getToken();return!(!e||this.isTokenExpired(e))}},{key:"logout",value:function(){localStorage.removeItem("id_token"),window.location.assign("/")}}]),e}()),v=s(2);function f(){return Object(v.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-primary data-bs-theme='dark' mb-3",children:Object(v.jsxs)("div",{className:"container-lg",children:[Object(v.jsx)(l.b,{to:"/",className:"navbar-brand fw-bold fs-2",children:"Virtual Book Club"}),Object(v.jsx)("div",{className:"collapse navbar-collapse justify-content-end",id:"navbarNavAltMarkup",children:Object(v.jsx)("div",{className:"navbar-nav",children:h.loggedIn()?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(l.b,{to:"/me",className:"nav-link fs-5 px-4",children:"My Account"}),Object(v.jsx)(l.b,{to:"/create",className:"nav-link fs-5 px-4",children:"Create a Post"}),Object(v.jsx)(l.b,{to:"/posts",className:"nav-link fs-5 px-4",children:"View Posts"}),Object(v.jsx)(l.b,{to:"/",className:"nav-link fs-5 px-4",onClick:function(e){e.preventDefault(),h.logout()},children:"Log Out"})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(l.b,{to:"/signup",className:"nav-link fs-5 px-4",children:"Sign Up"}),Object(v.jsx)(l.b,{to:"/login",className:"nav-link fs-5 px-4",children:"Log In"}),Object(v.jsx)(l.b,{to:"/posts",className:"nav-link fs-5 px-4",children:"View Posts"})]})})})]})})}function g(){return Object(v.jsxs)("div",{className:"container-md",children:[Object(v.jsx)("div",{className:"row text-center",children:Object(v.jsx)("h1",{className:"my-5",children:"Virtual Book Club"})}),Object(v.jsxs)("div",{className:"row text-center my-3",children:[Object(v.jsx)("p",{className:"fs-3 fw-light lh-1",children:"An online community where we"}),Object(v.jsx)("p",{className:"fs-3 fw-light lh-1",children:"share, connect, and learn with others"}),Object(v.jsx)("p",{className:"fs-3 fw-light lh-1",children:"in our love of books"})]}),Object(v.jsx)("div",{className:"row text-center my-5",children:Object(v.jsx)("p",{className:"fs-3 fw-lighter",children:"Click on one of the links above to get started!"})})]})}var N=s(8),w=s(15),y=s(12),k=s(9);var I,S,_,B,$,T=s(121),P=s(23),U=s(127),C=Object(U.a)(I||(I=Object(P.a)(["\n  mutation createUser($email: String!, $username: String!, $password: String!) {\n    createUser(email: $email, username: $username, password: $password) {\n      token\n      user{\n      _id\n      username\n      }\n    }\n  }\n"]))),D=Object(U.a)(S||(S=Object(P.a)(["\n  mutation login($username: String!, $password: String!) {\n    login(username: $username, password: $password) {\n      token\n      user {\n        _id\n        username\n      }\n    }\n  }\n"]))),A=(Object(U.a)(_||(_=Object(P.a)(["\n  mutation deleteUser($userId: ID!) {\n    deleteUser(userId: $userId) {\n      _id\n      username\n    }\n  }\n"]))),Object(U.a)(B||(B=Object(P.a)(["\n  mutation createPost($userId: ID!, $postTitle: String!, $postBody: String!) {\n    createPost(userId: $userId, postTitle: $postTitle, postBody: $postBody) {\n      _id\n      user {\n        _id\n        username\n      }\n      postTitle\n      postBody\n    }\n  }\n"]))));Object(U.a)($||($=Object(P.a)(["\n  mutation deletePost($postId: ID!) {\n    deletePost(postId: $postId) {\n      _id\n      postTitle\n    }\n  }\n"])));function L(){var e=Object(n.useState)({email:"",username:"",password:""}),t=Object(k.a)(e,2),s=t[0],a=t[1],c=Object(n.useState)(""),r=Object(k.a)(c,2),l=r[0],d=r[1],j=Object(T.a)(C),b=Object(k.a)(j,2),m=b[0],u=b[1],O=u.error,p=(u.data,Object(o.n)()),x=function(e){var t=e.target,n=t.name,c=t.value;a(Object(i.a)(Object(i.a)({},s),{},Object(y.a)({},n,c)))},f=function(){var e=Object(w.a)(Object(N.a)().mark((function e(t){var n,c;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=s.email,/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(String(r).toLowerCase())&&s.username){e.next=4;break}return d("Email or username is invalid. Please try again."),e.abrupt("return");case 4:if(s.password.match(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{8,}$/)){e.next=7;break}return d("Password did not meet the requirements. Please try again."),e.abrupt("return");case 7:return e.prev=7,e.next=10,m({variables:Object(i.a)({},s)});case 10:n=e.sent,c=n.data,h.login(c.createUser.token),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(7),console.error(e.t0);case 18:alert("Welcome to the club, ".concat(s.username,"!")),a({email:"",username:"",password:""}),p("/me");case 21:case"end":return e.stop()}var r}),e,null,[[7,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"container-md",children:[Object(v.jsx)("div",{className:"row text-center",children:Object(v.jsx)("h1",{children:"Sign Up"})}),Object(v.jsxs)("div",{className:"row justify-content-center",children:[Object(v.jsxs)("form",{className:"col-md-6",onSubmit:f,children:[Object(v.jsxs)("div",{className:"mb-3",children:[Object(v.jsx)("label",{for:"inputEmail",className:"form-label",children:"Email address"}),Object(v.jsx)("input",{type:"email",className:"form-control",id:"inputEmail",name:"email",value:s.email,onChange:x})]}),Object(v.jsxs)("div",{className:"mb-3",children:[Object(v.jsx)("label",{for:"inputUsername",className:"form-label",children:"Username"}),Object(v.jsx)("input",{type:"text",className:"form-control",id:"inputUsername",name:"username",value:s.username,onChange:x})]}),Object(v.jsxs)("div",{className:"mb-3",children:[Object(v.jsx)("label",{for:"exampleInputPassword1",className:"form-label",children:"Password"}),Object(v.jsx)("input",{type:"password",className:"form-control",id:"exampleInputPassword1",name:"password",value:s.password,onChange:x,"aria-describedby":"passwordHelpBlock"}),Object(v.jsx)("div",{id:"passwordHelpBlock",className:"form-text",children:"Your password must be at least 8 characters long, contain uppercase and lower letters and numbers, and must not contain spaces, special characters, or emoji."})]}),Object(v.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Submit"})]}),l&&Object(v.jsx)("div",{className:"row text-center my-3",children:Object(v.jsx)("p",{className:"error-text text-danger",children:l})}),O&&Object(v.jsx)("div",{className:"row text-center my-3",children:Object(v.jsx)("p",{className:"error-text text-danger",children:"Something went wrong..."})})]})]})}function q(e){var t=Object(n.useState)({username:"",password:""}),s=Object(k.a)(t,2),a=s[0],c=s[1],r=Object(T.a)(D),l=Object(k.a)(r,2),o=l[0],d=l[1],j=d.error,b=(d.data,function(e){var t=e.target,s=t.name,n=t.value;c(Object(i.a)(Object(i.a)({},a),{},Object(y.a)({},s,n)))}),m=function(){var e=Object(w.a)(Object(N.a)().mark((function e(t){var s,n;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,o({variables:Object(i.a)({},a)});case 4:s=e.sent,n=s.data,h.login(n.login.token),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:alert("Welcome back, ".concat(a.username,"!")),c({username:"",password:""});case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"container-md",children:[Object(v.jsx)("div",{className:"row text-center",children:Object(v.jsx)("h1",{children:"Log In"})}),Object(v.jsxs)("div",{className:"row justify-content-center",children:[Object(v.jsxs)("form",{className:"col-md-6",onSubmit:m,children:[Object(v.jsxs)("div",{className:"mb-3",children:[Object(v.jsx)("label",{for:"inputUsername",className:"form-label",children:"Username"}),Object(v.jsx)("input",{type:"text",className:"form-control",id:"inputUsername",name:"username",value:a.username,onChange:b})]}),Object(v.jsxs)("div",{className:"mb-3",children:[Object(v.jsx)("label",{for:"exampleInputPassword1",className:"form-label",children:"Password"}),Object(v.jsx)("input",{type:"password",className:"form-control",id:"exampleInputPassword1",name:"password",value:a.password,onChange:b})]}),Object(v.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Submit"})]}),j&&Object(v.jsx)("div",{className:"row text-center my-3",children:Object(v.jsx)("p",{className:"error-text text-danger",children:j.message})})]})]})}var E,M,V,z,F,H=s(129),J=(Object(U.a)(E||(E=Object(P.a)(["\n  query allUsers {\n    users {\n      _id\n      username\n      email\n      password\n      posts\n    }\n  }\n"]))),Object(U.a)(M||(M=Object(P.a)(["\n  query allPosts {\n    allPosts {\n      _id\n      user {\n        _id\n        username\n      }\n      postTitle\n      postBody\n      createdAt\n    }\n  }\n"])))),W=Object(U.a)(V||(V=Object(P.a)(["\n  query singlePost($postId: ID!) {\n    post(postId: $postId) {\n      _id\n      user {\n        _id\n        username\n      }\n      postTitle\n      postBody\n      createdAt\n    }\n  }\n"]))),Y=Object(U.a)(z||(z=Object(P.a)(["\n  query singleUser($userId: ID!) {\n    user(userId: $userId) {\n      _id\n      username\n      email\n      password\n      posts {\n        _id\n        postTitle\n        postBody\n        createdAt\n        user {\n          _id\n          username\n        }\n      }\n    }\n  }\n"]))),Z=Object(U.a)(F||(F=Object(P.a)(["\n  query me {\n    me {\n      _id\n      username\n      posts {\n        _id\n        postTitle\n        postBody\n        createdAt\n        user {\n          _id\n          username\n        }\n      }\n    }\n  }\n"])));function R(e){var t=e.posts;return t.length?Object(v.jsx)("div",{children:Object(v.jsx)("div",{className:"row justify-content-center",children:t&&t.map((function(e){return Object(v.jsx)("div",{className:"col-md-10",children:Object(v.jsxs)("div",{className:"card mb-3",children:[Object(v.jsxs)("div",{className:"card-header",children:[Object(v.jsx)("h4",{className:"card-title",children:e.postTitle}),Object(v.jsxs)("h5",{className:"card-subtitle text-muted",children:["By ",Object(v.jsx)(l.b,{to:"/user/".concat(e.user._id),children:e.user.username}),Object(v.jsx)("span",{style:{float:"right"},children:"".concat(new Date(Number.parseInt(e.createdAt)).toDateString())})]})]}),Object(v.jsxs)("div",{className:"card-body",children:[e.postBody.length>500?Object(v.jsx)("p",{className:"card-text",children:"".concat(e.postBody.substring(0,500),"...")}):Object(v.jsx)("p",{children:e.postBody}),Object(v.jsx)(l.b,{to:"/posts/".concat(e._id),children:"View post"})]})]})},e._id)}))})}):Object(v.jsx)("h4",{className:"offset-1 text-muted",children:"No posts"})}function G(){var e=Object(o.p)().userId,t=Object(H.a)(e?Y:Z,{variables:{userId:e}}),s=t.loading,n=t.data,a=(null===n||void 0===n?void 0:n.me)||(null===n||void 0===n?void 0:n.user)||{};return h.loggedIn()&&h.getUser().data._id===e?Object(v.jsx)(o.a,{to:"/me"}):s?Object(v.jsx)("div",{children:"Loading..."}):null!==a&&void 0!==a&&a.username?Object(v.jsx)("div",{className:"container-md",children:Object(v.jsx)("div",{className:"row justify-content-center",children:Object(v.jsxs)("div",{className:"col-10",children:[Object(v.jsx)("h2",{className:"text-center mb-4",children:"My Account"}),Object(v.jsx)("h3",{className:"text-start offset-1",children:"My posts"}),s?Object(v.jsx)("div",{children:"Loading..."}):Object(v.jsx)(R,{posts:a.posts})]})})}):Object(v.jsx)("div",{className:"container-md",children:Object(v.jsx)("div",{className:"row justify-content-center",children:Object(v.jsx)("div",{className:"col-10",children:Object(v.jsx)("h4",{className:"text-center",children:"You need to be logged in to see your page. Use the navigation links above to sign up or log in."})})})})}function K(){var e=Object(H.a)(J),t=e.loading,s=e.data,n=(null===s||void 0===s?void 0:s.allPosts)||[];return Object(v.jsx)("div",{className:"container-md",children:Object(v.jsx)("div",{className:"row justify-content-center",children:Object(v.jsxs)("div",{className:"col-10",children:[Object(v.jsx)("h2",{className:"text-center mb-4",children:"Recent Posts"}),t?Object(v.jsx)("div",{children:"Loading..."}):Object(v.jsx)(R,{posts:n})]})})})}function Q(){var e=Object(o.p)().postId,t=Object(H.a)(W,{variables:{postId:e}}),s=t.loading,n=t.data,a=(null===n||void 0===n?void 0:n.post)||{};return s?Object(v.jsx)("div",{children:"Loading..."}):Object(v.jsx)("div",{className:"container-md",children:Object(v.jsx)("div",{className:"row justify-content-center",children:Object(v.jsx)("div",{className:"col-md-8",children:Object(v.jsxs)("div",{className:"card mb-3",children:[Object(v.jsxs)("div",{className:"card-header",children:[Object(v.jsx)("h3",{className:"card-title",children:a.postTitle}),Object(v.jsxs)("h5",{className:"card-subtitle text-muted",children:["By ",Object(v.jsx)(l.b,{to:"/user/".concat(a.user._id),children:a.user.username}),Object(v.jsx)("span",{style:{float:"right"},children:"".concat(new Date(Number.parseInt(a.createdAt)).toDateString())})]})]}),Object(v.jsx)("div",{className:"card-body",children:Object(v.jsx)("p",{children:a.postBody})})]})},a._id)})})}function X(){var e=Object(n.useState)({postTitle:"",postBody:""}),t=Object(k.a)(e,2),s=t[0],a=t[1],c=h.getUser().data._id,r=Object(T.a)(A),l=Object(k.a)(r,2),o=l[0],d=l[1],j=(d.error,d.data,function(e){var t=e.target,n=t.name,c=t.value;a(Object(i.a)(Object(i.a)({},s),{},Object(y.a)({},n,c)))}),b=function(){var e=Object(w.a)(Object(N.a)().mark((function e(t){var n;return Object(N.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,o({variables:Object(i.a)({userId:c},s)});case 4:n=e.sent,n.data,a({postTitle:"",postBody:""}),window.location.assign("/me"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{className:"container-md",children:[Object(v.jsx)("div",{className:"row text-center",children:Object(v.jsx)("h1",{children:"Create a post"})}),Object(v.jsx)("div",{className:"row justify-content-center",children:Object(v.jsxs)("form",{className:"col-md-6",onSubmit:b,children:[Object(v.jsxs)("div",{className:"mb-3",children:[Object(v.jsx)("label",{for:"inputBookTitle",className:"form-label",children:"Post title"}),Object(v.jsx)("input",{type:"text",className:"form-control",id:"inputBookTitle",name:"postTitle",value:s.postTitle,onChange:j})]}),Object(v.jsxs)("div",{className:"mb-3",children:[Object(v.jsx)("label",{for:"inputText",className:"form-label",children:"Post"}),Object(v.jsx)("textarea",{className:"form-control",id:"inputText",rows:"10",name:"postBody",value:s.postBody,onChange:j})]}),Object(v.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Submit"})]})})]})}var ee=Object(d.a)({uri:"/graphql"}),te=Object(u.a)((function(e,t){var s=t.headers,n=localStorage.getItem("id_token");return{headers:Object(i.a)(Object(i.a)({},s),{},{authorization:n?"Bearer ".concat(n):""})}})),se=new j.a({link:te.concat(ee),cache:new b.a});function ne(){return Object(v.jsx)(m.a,{client:se,children:Object(v.jsxs)(l.a,{children:[Object(v.jsx)(f,{}),Object(v.jsxs)(o.d,{children:[Object(v.jsx)(o.b,{path:"/",element:Object(v.jsx)(g,{})}),Object(v.jsx)(o.b,{path:"/signup",element:Object(v.jsx)(L,{})}),Object(v.jsx)(o.b,{path:"/login",element:Object(v.jsx)(q,{})}),Object(v.jsx)(o.b,{path:"/me",element:Object(v.jsx)(G,{})}),Object(v.jsx)(o.b,{path:"/user/:userId",element:Object(v.jsx)(G,{})}),Object(v.jsx)(o.b,{path:"/posts",element:Object(v.jsx)(K,{})}),Object(v.jsx)(o.b,{path:"/posts/:postId",element:Object(v.jsx)(Q,{})}),Object(v.jsx)(o.b,{path:"/create",element:Object(v.jsx)(X,{})})]})]})})}s(91),s(92);r.a.render(Object(v.jsx)(a.a.StrictMode,{children:Object(v.jsx)(ne,{})}),document.getElementById("root"))}},[[113,1,2]]]);
//# sourceMappingURL=main.cefc745a.chunk.js.map